@model VanLocWeb.Models.NewsItem
@{
    ViewData["Title"] = Model.Title + " - Hội đồng hương Vạn Lộc";
}

<section class="bg-cream py-20 lg:py-32">
    <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto">
            <div class="mb-12">
                <span
                    class="px-4 py-1.5 bg-primary/10 text-primary rounded-full text-[10px] font-bold uppercase tracking-widest mb-8 inline-block">@Model.Category</span>
                <h1 class="font-display text-4xl md:text-6xl font-bold text-charcoal mb-10 leading-[1.1]">@Model.Title
                </h1>
                <div class="flex items-center gap-8 py-8 border-y border-secondary/10">
                    <div class="flex items-center gap-3 text-sm text-secondary font-bold uppercase tracking-widest">
                        <i class="bi bi-calendar3"></i> @Model.PublishDate.ToString("dd/MM/yyyy")
                    </div>
                    <div class="flex items-center gap-3 text-sm text-secondary font-bold uppercase tracking-widest">
                        <i class="bi bi-eye"></i> 1.2k lượt xem
                    </div>
                    @if (Model.Visibility == VanLocWeb.Models.AccessLevel.Internal)
                    {
                        <div class="ml-auto text-accent flex items-center gap-2 text-xs font-bold uppercase">
                            <i class="bi bi-lock-fill"></i> Nội bộ
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</section>

<div class="container mx-auto px-4 -mt-20 lg:-mt-32 relative z-10">
    <div class="max-w-4xl mx-auto">
        @if (Model.Images != null && Model.Images.Count > 1)
        {
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-20">
                @foreach (var img in Model.Images)
                {
                    <img src="@img"
                        class="w-full aspect-[4/3] object-cover rounded-[2rem] shadow-lg hover:scale-105 transition-transform duration-500 cursor-pointer"
                        onclick="openLightbox('@img')" alt="@Model.Title">
                }
            </div>
        }
        else
        {
            <img src="@(string.IsNullOrEmpty(Model.ImageUrl) ? $"https://picsum.photos/seed/{Model.Id + 30}/1200/600" : Model.ImageUrl)"
                class="w-full aspect-[2/1] object-cover rounded-[3rem] shadow-2xl mb-20" alt="@Model.Title">
        }

        <div class="bg-white p-10 md:p-20 rounded-[3rem] shadow-xl border border-secondary/5">
            <div class="prose prose-lg prose-stone max-w-none text-[#6b705c] leading-[1.8] space-y-8">
                <p class="text-2xl font-display font-medium text-charcoal leading-relaxed">@Model.Summary</p>
                <div class="content-body">
                    @Html.Raw(Model.Content.Replace("\n", "<p>").Replace("<p>", "</p><p class='mb-8'>"))
                    @if (string.IsNullOrEmpty(Model.Content))
                    {
                        <p>Thông tin chi tiết về bài viết đang được Ban biên tập cập nhật. Quý độc giả vui lòng quay lại sau
                            để theo dõi đầy đủ nội dung hoặc liên hệ trực tiếp với Ban chấp hành Hội để được giải đáp thắc
                            mắc.</p>
                        <p>Chúng tôi luôn nỗ lực mang đến những thông tin chính xác và kịp thời nhất cho bà con đồng hương
                            xa quê.</p>
                    }
                </div>
            </div>

            <!-- Share -->
            <div
                class="mt-20 pt-12 border-t border-secondary/5 flex flex-col md:flex-row items-center justify-between gap-8">
                <div class="flex items-center gap-4">
                    <span class="text-xs font-bold text-secondary uppercase tracking-widest">Chia sẻ:</span>
                    <div class="flex gap-3">
                        <a href="https://www.facebook.com/sharer/sharer.php?u=@(Context.Request.Scheme)://@(Context.Request.Host)@(Context.Request.Path)"
                            target="_blank"
                            class="w-10 h-10 rounded-full bg-primary/5 text-primary flex items-center justify-center hover:bg-primary hover:text-white transition-all"><i
                                class="bi bi-facebook"></i></a>
                        <a href="https://zalo.me/share?url=@(Context.Request.Scheme)://@(Context.Request.Host)@(Context.Request.Path)"
                            target="_blank"
                            class="w-10 h-10 rounded-full bg-accent/5 text-accent flex items-center justify-center hover:bg-accent hover:text-white transition-all"><i
                                class="bi bi-chat-dots"></i></a>
                        <button
                            onclick="navigator.clipboard.writeText(window.location.href); alert('Đã sao chép liên kết!');"
                            class="w-10 h-10 rounded-full bg-secondary/5 text-secondary flex items-center justify-center hover:bg-secondary hover:text-white transition-all"><i
                                class="bi bi-link-45deg"></i></button>
                    </div>
                </div>
                <a asp-action="News" class="text-sm font-bold text-charcoal hover:underline">Quay lại Tin tức</a>
            </div>
        </div>

        <!-- Related -->
        <div class="mt-32">
            <h4 class="text-2xl font-bold text-charcoal mb-12">Bài viết liên quan</h4>
            <div class="grid md:grid-cols-2 gap-8">
                <a asp-action="NewsDetail" asp-route-id="2"
                    class="group flex gap-6 p-6 bg-white rounded-3xl border border-secondary/10 hover:shadow-xl transition-all no-underline">
                    <img src="https://picsum.photos/seed/rel1/100/100" class="w-24 h-24 rounded-2xl object-cover"
                        alt="Related">
                    <div>
                        <time
                            class="text-[10px] font-bold text-secondary uppercase tracking-widest mb-2 block">28/01/2025</time>
                        <h6 class="text-charcoal font-bold group-hover:text-primary transition-colors leading-snug">Kêu
                            gọi ủng hộ Quỹ khuyến học Vạn Lộc năm 2025</h6>
                    </div>
                </a>
                <a asp-action="NewsDetail" asp-route-id="3"
                    class="group flex gap-6 p-6 bg-white rounded-3xl border border-secondary/10 hover:shadow-xl transition-all no-underline">
                    <img src="https://picsum.photos/seed/rel2/100/100" class="w-24 h-24 rounded-2xl object-cover"
                        alt="Related">
                    <div>
                        <time
                            class="text-[10px] font-bold text-secondary uppercase tracking-widest mb-2 block">15/01/2025</time>
                        <h6 class="text-charcoal font-bold group-hover:text-primary transition-colors leading-snug">Tổng
                            kết hoạt động thiện nguyện miền Trung</h6>
                    </div>
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Lightbox for Detail Images -->
<div id="detailLightbox"
    class="fixed inset-0 z-[10000] bg-charcoal/95 backdrop-blur-xl flex items-center justify-center opacity-0 pointer-events-none transition-opacity duration-300"
    onclick="closeDetailLightbox()">
    <img id="detailLightboxImg" src="" class="max-h-[85vh] max-w-[90vw] rounded-2xl shadow-2xl">
</div>

<script>
    function openLightbox(src) {
        document.getElementById('detailLightboxImg').src = src;
        document.getElementById('detailLightbox').classList.remove('opacity-0', 'pointer-events-none');
    }
    function closeDetailLightbox() {
        document.getElementById('detailLightbox').classList.add('opacity-0', 'pointer-events-none');
    }
</script>

<style>
    .hover-bg-light:hover {
        background-color: #f8f9fa;
    }

    .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
</style>
